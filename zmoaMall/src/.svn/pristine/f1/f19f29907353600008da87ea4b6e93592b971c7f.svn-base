<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zm.mall.dao.business.product.ProductCategoriesDao">
    <resultMap id="ProductCategoriesMap" type="com.zm.mall.domain.business.product.ProductCategories">
        <result column="CategoryId" property="categoryId" jdbcType="BIGINT"></result>
        <result column="ProductId" property="productId" jdbcType="BIGINT"></result>
        <result column="CategoryPath" property="categoryPath" jdbcType="VARCHAR"></result>
    </resultMap>

    <!--判断平台Id-->
    <sql id="b2c_condition">
        <if test="pluteformid !=null  and  pluteformid  !='' ">
            AND pluteformid=#{pluteformid}
        </if>
    </sql>

    <sql id="all_column">categoryid,productid,categorypath</sql>
    <!--根据分类id查询-->
    <select id="selectByCategoryId" resultType="productCategories" parameterType="int">
         SELECT
         <include refid="all_column"/>
         FROM b2c_shop_productcategories
         WHERE categoryid = #{categoryId}
        <include refid="b2c_condition"/>
    </select>
    <!--根据产品id查询-->
    <select id="selectByProductId" resultMap="ProductCategoriesMap" parameterType="productInfo">
        SELECT
        <include refid="all_column"/>
        FROM b2c_shop_productcategories
        WHERE productid = #{productId}
        <include refid="b2c_condition"/>
    </select>
    <!--根据路径查询-->
    <select id="selectByCategoryPath" resultType="productCategories" parameterType="string">
        SELECT
        <include refid="all_column"/>
        FROM b2c_shop_productcategories
        WHERE categorypath = #{CategoryPath}
        <include refid="b2c_condition"/>
    </select>
    <insert id="InsertPath" parameterType="productCategories">
        INSERT INTO
        b2c_shop_productcategories(categoryid,productid,categorypath,shopId,pluteformid)
        VALUES (#{categoryId},#{productId},#{categoryPath},#{shopId},#{pluteformid})
    </insert>
    <delete id="delProductCategoriesDao" parameterType="productInfo">
        DELETE  FROM b2c_shop_productcategories
        where productid =#{productId}
        <include refid="b2c_condition"/>
    </delete>
</mapper>