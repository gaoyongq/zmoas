<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zm.mall.dao.system.MenusDao">

    <resultMap id="PrivilegeMap" type="com.zm.mall.domain.system.Privileges">
        <result column="id" property="id" jdbcType="BIGINT"/>
        <result column="privilegeid" property="pid" jdbcType="BIGINT"/>
        <result column="name" property="name" jdbcType="VARCHAR"/>
        <result column="url" property="url" jdbcType="VARCHAR"/>
        <result column="pluteformid" property="pluteformid" jdbcType="VARCHAR"/>
    </resultMap>

    <sql id="all_column">id ,privilegeid,name , url  </sql>

    <sql id="condition">
        <if test="id != null  and id > 0">
            AND id = #{id}
        </if>
        <if test="pid != null  and pid > 0">
            AND privilegeid = #{pid}
        </if>

        <if test="name != null and name >0">
            AND name = #{name}
        </if>
        <if test="url != null and url !=''">
            AND url = #{url}
        </if>
    </sql>



    <select id="selectAllByContion" resultMap="PrivilegeMap" parameterType="role">
        SELECT
        *
        FROM b2c_privilege
        WHERE id IN (SELECT privilege_id FROM b2c_privilege_role WHERE role_privilege=#{id})
<!--AND pluteformid=#{pluteformid}-->
    </select>


    <select id="getAllUrls" resultMap="PrivilegeMap" >
        SELECT
        url
        FROM privilege
        WHERE url is not null
    </select>

    <select id="getTopPrivilege" resultMap="PrivilegeMap" >
        SELECT
        <include refid="all_column"/>
        FROM privilege
        WHERE privilegeid is null
    </select>

</mapper>