<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zm.mall.dao.business.shopUser.ShopUserDao">
    <!--订单基本信息查询结果集-->
    <resultMap id="ShopUserMap" type="shopUser">
        <result column="shopUserId" property="shopUserId" jdbcType="BIGINT"/>
        <result property="pluteformid" column="pluteformid" jdbcType="VARCHAR"/>
        <result property="shopInfoId" column="shopInfoId" jdbcType="BIGINT"/>
        <result property="userId" column="userId" jdbcType="BIGINT"/>
        <result property="openId" column="openId" jdbcType="VARCHAR"/>
        <result property="createTime" column="createTime" jdbcType="VARCHAR"/>

    </resultMap>
    <sql id="all_column">shopUserId,pluteformid,shopInfoId,userId,openId,createTime</sql>
    <!--增加店铺用户关联表数据-->
    <insert id="insertShopUser" parameterType="shopUser">
      INSERT  INTO b2c_shopUser(pluteformid,openId,shopInfoId,userId) VALUES
      (#{pluteformid},#{openId},#{shopInfoId},#{userId})
    </insert>
    <!--根据userId和shopID查询-->
    <select id="selectByUserIdhShopId" resultMap="ShopUserMap" parameterType="shopUser">
    SELECT <include refid="all_column"></include> from b2c_shopUser
        where userId=#{userId}
        <if test="pluteformid!='' and pluteformid!=null">
            AND  pluteformid = #{pluteformid}
        </if>
        <if test="openId!='' and openId!=null">
            AND  openId = #{openId}
        </if>
        <if test="shopInfoId!='' and shopInfoId!=null">
            AND  shopInfoId = #{shopInfoId}
        </if>
        ORDER BY createTime DESC
    </select>
</mapper>
