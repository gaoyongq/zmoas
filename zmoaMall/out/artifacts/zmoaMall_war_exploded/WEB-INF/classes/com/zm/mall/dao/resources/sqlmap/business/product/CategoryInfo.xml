<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.zm.mall.dao.business.product.CategoryInfoDao">
       <resultMap id="CategoryInfoMap" type="com.zm.mall.domain.business.product.CategoryInfo">
              <result column="CategoryId" property="categoryId" jdbcType="BIGINT"></result>
              <result column="Name" property="name" jdbcType="VARCHAR"></result>
              <result column="DisplaySequence" property="displaySequence" jdbcType="BIGINT"></result>
              <result column="Meta_Title" property="meta_Title" jdbcType="VARCHAR"></result>
              <result column="Meta_Description" property="meta_Description" jdbcType="VARCHAR"></result>
              <result column="Meta_Keywords" property="meta_Keywords" jdbcType="VARCHAR"></result>
              <result column="Description" property="description" jdbcType="VARCHAR"></result>
              <result column="ParentCategoryId" property="parentCategoryId" jdbcType="BIGINT"></result>
              <result column="Depth" property="depth" jdbcType="BIGINT"></result>
              <result column="Path" property="path" jdbcType="VARCHAR"></result>
              <result column="RewriteName" property="rewriteName" jdbcType="VARCHAR"></result>
              <result column="SKUPrefix" property="skuPrefix" jdbcType="VARCHAR"></result>
              <result column="AssociatedProductType" property="associatedProductType" jdbcType="BIGINT"></result>
              <result column="ImageUrl" property="imageUrl" jdbcType="VARCHAR"></result>
              <result column="Notes1" property="notes1" jdbcType="VARCHAR"></result>
              <result column="Notes2" property="notes2" jdbcType="VARCHAR"></result>
              <result column="Notes3" property="notes3" jdbcType="VARCHAR"></result>
              <result column="Notes4" property="notes4" jdbcType="VARCHAR"></result>
              <result column="Notes5" property="notes5" jdbcType="VARCHAR"></result>
              <result column="SeoUrl" property="seoUrl" jdbcType="VARCHAR"></result>
              <result column="SeoImageAlt" property="seoImageAlt" jdbcType="VARCHAR"></result>
              <result column="SeoImageTitle" property="seoImageTitle" jdbcType="VARCHAR"></result>
              <result column="Status" property="status" jdbcType="BOOLEAN"></result>
              <result column="PriceChange" property="priceChange" jdbcType="DOUBLE"></result>
       </resultMap>

       <!--判断平台Id-->
       <sql id="b2c_condition">
              <if test="pluteformid !=null  and  pluteformid  !='' ">
                     AND pluteformid=#{pluteformid}
              </if>
       </sql>

       <sql id="all_column">categoryid,name,displaysequence,description,parentcategoryid,depth,path,associatedproducttype,imageurl,haschildren,status</sql>
       <!--查询分类集合-->
       <select id="selectAll" resultMap="CategoryInfoMap" parameterType="categoryInfo" >
              SELECT
              <include refid="all_column"/>
              FROM b2c_shop_categories
              where status = 1
              <include refid="b2c_condition"/>
       </select>
       <select id="price" resultType="CategoryInfo" parameterType="categoryInfo">
              SELECT *
              FROM b2c_shop_categories
              where status = 1 AND path = #{path}
              <include refid="b2c_condition"/>
       </select>
       <select id="categoryInfoListById" resultMap="CategoryInfoMap" parameterType="categoryInfo">
               SELECT *
               from b2c_shop_categories
               WHERE ParentCategoryId = (SELECT ParentCategoryId from b2c_shop_categories s WHERE CategoryId =#{categoryId})
              <include refid="b2c_condition"/>
       </select>
       <select id="categoryInfoListByIdOnIn" resultMap="CategoryInfoMap">
               SELECT *
               from b2c_shop_categories
               WHERE CategoryId IN
              <foreach collection="array" index="index" item="item" open="(" separator="," close=")">
                     #{item}
              </foreach>
              ORDER BY Depth ASC
       </select>
       <select id="weCartAddAppSelectCategory" resultMap="CategoryInfoMap" parameterType="categoryInfo">
              SELECT  *
              FROM b2c_shop_categories
              WHERE ParentCategoryId=#{parentCategoryId}
              <include refid="b2c_condition"/>
       </select>
</mapper>
